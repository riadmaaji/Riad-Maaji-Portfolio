---
import LanguageToggle from './LanguageToggle.astro';
import SocialLinks from './SocialLinks.astro';
import { useTranslations, type Language } from '../i18n';

interface Props {
  lang: Language;
}

const { lang } = Astro.props;
const t = useTranslations(lang);

const navLinks = [
  { href: `/${lang}/`, label: t('nav.home') },
  { href: `/${lang}/projects`, label: t('nav.projects') },
  { href: `/${lang}/#about`, label: t('nav.about') },
  { href: `/${lang}/#skills`, label: t('nav.skills') },
];

const currentPath = Astro.url.pathname;
---

<header class="sticky top-0 z-50 flex justify-center pt-4 px-4 animate-slide-down">
  <nav class="backdrop-blur-md bg-zinc-900/90 border border-zinc-700/50 rounded-full px-6 h-14 flex items-center justify-center shadow-lg shadow-black/20">
    <!-- Desktop Navigation -->
    <ul class="hidden sm:flex items-center gap-6">
      {navLinks.map(({ href, label }) => (
        <li>
          <a
            href={href}
            class="text-sm font-medium transition-all duration-300 hover-underline text-zinc-300 hover:text-zinc-100"
          >
            {label}
          </a>
        </li>
      ))}
    </ul>

    <!-- Separator -->
    <div class="hidden sm:block w-px h-5 bg-zinc-700 mx-4"></div>

    <!-- Social Links (Desktop) -->
    <div class="hidden sm:flex items-center gap-3">
      <SocialLinks />
    </div>

    <!-- Separator -->
    <div class="hidden sm:block w-px h-5 bg-zinc-700 mx-4"></div>

    <!-- Language Toggle (Desktop) -->
    <div class="hidden sm:flex">
      <LanguageToggle lang={lang} />
    </div>

    <!-- Mobile Menu Button -->
    <button
      id="mobile-menu-btn"
      type="button"
      class="sm:hidden p-2 text-zinc-300 hover:text-zinc-100 transition-colors"
      aria-label="Toggle menu"
      aria-expanded="false"
    >
      <svg id="menu-icon-open" class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
      <svg id="menu-icon-close" class="w-7 h-7 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>

    <!-- Mobile Language Toggle -->
    <div class="sm:hidden">
      <LanguageToggle lang={lang} />
    </div>
  </nav>

  <!-- Mobile Navigation Menu -->
  <div id="mobile-menu" class="hidden sm:hidden absolute top-full left-4 right-4 mt-2 border border-zinc-700/50 bg-zinc-900/95 backdrop-blur-md rounded-2xl shadow-lg shadow-black/20">
    <ul class="px-6 py-4 space-y-3">
      {navLinks.map(({ href, label }) => (
        <li>
          <a
            href={href}
            class="block text-lg font-medium transition-all duration-300 py-2 text-zinc-300 hover:text-zinc-100"
          >
            {label}
          </a>
        </li>
      ))}
    </ul>
    <!-- Social Links (Mobile) -->
    <div class="px-6 pb-4">
      <SocialLinks />
    </div>
  </div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const menuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    const iconOpen = document.getElementById('menu-icon-open');
    const iconClose = document.getElementById('menu-icon-close');

    if (!menuBtn || !mobileMenu || !iconOpen || !iconClose) return;

    menuBtn.addEventListener('click', () => {
      const isOpen = !mobileMenu.classList.contains('hidden');
      
      if (isOpen) {
        mobileMenu.classList.add('hidden');
        iconOpen.classList.remove('hidden');
        iconClose.classList.add('hidden');
        menuBtn.setAttribute('aria-expanded', 'false');
      } else {
        mobileMenu.classList.remove('hidden');
        iconOpen.classList.add('hidden');
        iconClose.classList.remove('hidden');
        menuBtn.setAttribute('aria-expanded', 'true');
      }
    });
  });
</script>
